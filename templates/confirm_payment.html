{% load static %}
{% load filter %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Pizza - Mania</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link rel="stylesheet" href="{% static "css/confirm_payment.css" %}"/>

  </head>
    <body>
    
    {% comment %} This is used to display the messages that is been sent by the backend. {% endcomment %}
    {% if messages %}
        {% for message in messages %}
            
            <div class="alert alert-warning alert-dismissible fade show fixed-top" role="alert">
                <b><strong style="text-transform: capitalize;">{{ message.tags }}</strong></b> | {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <b><span aria-hidden="false">&times;</span></b>
                </button>
            </div>

        {% endfor%}
    {% endif %}

        <div class="container bg-light d-md-flex align-items-center">
            <div class="card box1 shadow-sm p-md-5 p-md-5 p-4">
                <div class="fw-bolder mb-4"><b>₹<span class="ps-1">{{ item_price }}.00</span></b></div>
                <div class="d-flex flex-column">
                    <div class="d-flex align-items-center justify-content-between text"><b><span class="">Delivery Charge</span></b>
                        <b>₹<span class="ps-1">{{ delivery_price }}</span></b></div>
                    <div class="d-flex align-items-center justify-content-between text mb-4"><b><span>Total</span></b>
                        <b><span class="ps-1">₹{{ total_price }}.00</span></span></b></div>
                    <div class="border-bottom mb-4"></div>
                    <div class="d-flex flex-column mb-4">
                        <span class="far fa-file-alt text"><span class="pl-2">Invoice ID:</span></span>
                        <span class="ps-3">SN8478042099</span> </div>
                    <div class="d-flex flex-column mb-5">
                        <span class="far fa-calendar-alt text"><span class="pl-2">Next payment:</span></span>
                        <span class="ps-3">22 july,2018</span> </div>
                    <div class="d-flex align-items-center justify-content-between text mt-5">
                        <div class="d-flex flex-column text"> <span>Customer Support:</span> <span>online chat 24/7</span>
                        </div>
                        <div class="btn btn-primary rounded-circle"><span class="fas fa-comment-alt"></span></div>
                    </div>
                </div>
            </div>
            <div class="card box2 shadow-sm">
                <div class="d-flex align-items-center justify-content-between p-md-5 p-4">
                    <span class="h5 fw-bold m-0">Payment methods</span>
                </div>
                <ul class="nav nav-tabs mb-3 px-md-4 px-2">
                    <li class="nav-item"> <a class="nav-link px-2 active" aria-current="page" href="#">Credit Card</a> </li>
                </ul>
                <div class="px-md-5 px-4 mb-4 d-flex align-items-center">
                    <div class="btn-group" role="group" aria-label="Basic radio toggle button group"> 
                        <input type="radio" class="btn-check mr-1" name="btnradio" id="btnradio1" autocomplete="off">
                        <label class="btn btn-outline-primary" for="btnradio1"><span class="pe-1">+</span>6741</label> 
                        
                        <input type="radio" class="btn-check mr-1" name="btnradio" id="btnradio2" autocomplete="off">
                        <label class="btn btn-outline-primary" for="btnradio2"><span class="lpe-1">+</span>7281</label>
                        
                        <label class="btn btn-outline-primary" id="btnradio3">Refresh</label>
                    </div>
                </div>
                
                <form action="/confirm_payment/" method="POST">
                    {% csrf_token %}

                    <div class="row">
                        <div class="col-12">
                            <div class="d-flex flex-column px-md-5 px-4 mb-4"> <span>Credit Card</span>
                                <div class="inputWithIcon"> 
                                    <input class="form-control" type="text" placeholder ="5136 1845 5468 3894" id="credit-number" name="credit-number" required>
                                    <span class=""> <img src="https://www.freepnglogos.com/uploads/mastercard-png/mastercard-logo-logok-15.png" alt=""></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex flex-column ps-md-5 px-md-0 px-4 mb-4 ml-5">
                                <span>Expiration<span class="ps-1">Date</span></span>
                                <div class="inputWithIcon"> 
                                    <input type="text" class="form-control" placeholder="05/20" id="credit-date" name="credit-date" required>
                                    <span class="fas fa-calendar-alt"></span> </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex flex-column pe-md-5 px-md-0 px-4 mb-4 mr-5"> <span>Code CVV</span>
                                <div class="inputWithIcon"> 
                                    <input type="password" class="form-control" name="credit-cvv" id="credit-cvv" required>
                                    <span class="fas fa-lock"></span> </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="d-flex flex-column px-md-5 px-4 mb-4"> <span>Name</span>
                                <div class="inputWithIcon"> 
                                    <input class="form-control text-uppercase" id="credit-name" name="credit-name" type="text" placeholder="ankit dey" required>
                                    <span class="far fa-user"></span> </div>
                            </div>
                        </div>
                        <div class="col-12 px-md-5 px-4 mt-3">
                            <button type="submit" class="btn btn-primary w-100">Pay  ₹{{ total_price }}.00</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

    
    <script>
        const inputField = document.querySelector('#credit-number');

        // Add an event listener to the input field
        inputField.addEventListener('input', (event) => {
        // Get the value of the input field
        const inputValue = event.target.value;

        console.log(inputValue);

        if (inputValue.length > 19) {
            document.getElementById("credit-number").value = inputValue.slice(0, - 1);
        };

        if (inputValue.length == 4 || inputValue.length == 9 || inputValue.length == 14) {
            document.getElementById("credit-number").value = inputValue + " ";
        };
        });

        
        // This is used to modify the date field.
        const dateField = document.querySelector('#credit-date'); 
        
        dateField.addEventListener('input', (event) => {

            const dateValue = event.target.value;

            if (dateValue.length > 5) {
                document.getElementById("credit-date").value = dateValue.slice(0, - 1);
            };

            if (dateValue.length == 2) {
                document.getElementById("credit-date").value = dateValue + "/";
            };
        });
        
        
        const cvvField = document.querySelector('#credit-cvv');

        cvvField.addEventListener('input', (event) => {

            const cvvValue = event.target.value;
            console.log(`CVV value : ${cvvValue.length}`);

            if (cvvValue.length > 3) {
                document.getElementById("credit-cvv").value = cvvValue.slice(0, -1);
            }
        })


        // This is used to check whether a saved card is clicked on the website.
        // For Card 1.
        const cardField1 = document.querySelector('#btnradio1');

        cardField1.addEventListener('click', (event) => {
            document.getElementById("credit-number").value = "{{ card_num_1 }}";
            document.getElementById("credit-date").value = "{{ card_date_1 }}";
            document.getElementById("credit-name").value = "{{ card_name_1 }}";
        });

        // For Card 2.
        const cardField2 = document.querySelector('#btnradio2');

        cardField2.addEventListener('click', (event) => {
            document.getElementById("credit-number").value = "{{ card_num_2 }}";
            document.getElementById("credit-date").value = "{{ card_date_2 }}";
            document.getElementById("credit-name").value = "{{ card_name_2 }}";
        });

        // For the Refresh Button.
        const refreshButton = document.querySelector('#btnradio3');

        refreshButton.addEventListener('click', (event) => {
            document.getElementById("credit-number").value = "";
            document.getElementById("credit-date").value = "";
            document.getElementById("credit-cvv").value = "";
            document.getElementById("credit-name").value = "";
            
            // When we'll remove the card that is alredy added then we also have to uncheck the card selections.
            document.querySelector('#btnradio1').checked = false;
            document.querySelector('#btnradio2').checked = false;
        });

    </script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    </body>
</html>
